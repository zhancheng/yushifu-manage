import{d as M,r as w,F as y,o as N,y as F,C as t,D as a,N as I,M as R,z as E,O as P,A as m,G as j,H as l,I as q,J as G,L as H,E as r,P as J,Q as O,R as Q,B as _,S as $,T as K,U as W,V as X,q as Y,_ as Z}from"#entry";import{u as ee}from"./Dte0BtBY.js";import{u as te}from"./B3RAIxuh.js";const ae={class:"dashboard-container"},oe={class:"card-header"},ne={class:"pagination"},se=M({__name:"records",setup(le){const h=te(),v=ee(),c=w(!1),g=w([]),i=y({userId:""}),s=y({page:1,limit:10,total:0}),p=async()=>{c.value=!0;try{const n={page:s.page,limit:s.limit};i.userId&&(n.userId=i.userId);const e=await v.get("/admin/identification/records",{params:n});g.value=e.data.records||[],s.total=e.data.total||0}catch(n){I.error(n.response?.data?.message||"获取数据失败")}finally{c.value=!1}},C=()=>{s.page=1,p()},x=()=>{i.userId="",s.page=1,p()},D=n=>{if(!n){I.warning("调试URL不存在");return}window.open(n,"_blank")},k=n=>new Date(n).toLocaleString("zh-CN"),f=n=>n?.membershipExpiresAt?new Date(n.membershipExpiresAt)>new Date:!1,z=async()=>{await X.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),h.logout(),await Y("/login")};return N(()=>{p()}),(n,e)=>{const u=H,B=G,b=q,S=j,d=Q,T=$,A=O,U=W,V=R,L=K;return E(),F("div",ae,[t(V,null,{header:a(()=>[m("div",oe,[e[4]||(e[4]=m("span",null,"用户识别记录",-1)),t(u,{type:"danger",onClick:z},{default:a(()=>[...e[3]||(e[3]=[r("退出登录",-1)])]),_:1})])]),default:a(()=>[t(S,{inline:!0,model:l(i),class:"search-form"},{default:a(()=>[t(b,{label:"用户ID"},{default:a(()=>[t(B,{modelValue:l(i).userId,"onUpdate:modelValue":e[0]||(e[0]=o=>l(i).userId=o),placeholder:"请输入用户ID",clearable:""},null,8,["modelValue"])]),_:1}),t(b,null,{default:a(()=>[t(u,{type:"primary",onClick:C},{default:a(()=>[...e[5]||(e[5]=[r("搜索",-1)])]),_:1}),t(u,{onClick:x},{default:a(()=>[...e[6]||(e[6]=[r("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),P((E(),J(A,{data:l(g),border:"",stripe:"",style:{width:"100%"}},{default:a(()=>[t(d,{prop:"id",label:"ID",width:"80"}),t(d,{prop:"userId",label:"用户ID"}),t(d,{label:"用户昵称",width:"150"},{default:a(({row:o})=>[r(_(o.user?.nickname||"-"),1)]),_:1}),t(d,{label:"会员状态",width:"100"},{default:a(({row:o})=>[t(T,{type:f(o.user)?"success":"info"},{default:a(()=>[r(_(f(o.user)?"会员":"普通用户"),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"createdAt",label:"创建时间",width:"180"},{default:a(({row:o})=>[r(_(k(o.createdAt)),1)]),_:1}),t(d,{label:"操作",fixed:"right",width:"150"},{default:a(({row:o})=>[t(u,{type:"primary",size:"small",onClick:re=>D(o.debugUrl)},{default:a(()=>[...e[7]||(e[7]=[r(" 查看调试 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,l(c)]]),m("div",ne,[t(U,{"current-page":l(s).page,"onUpdate:currentPage":e[1]||(e[1]=o=>l(s).page=o),"page-size":l(s).limit,"onUpdate:pageSize":e[2]||(e[2]=o=>l(s).limit=o),"page-sizes":[10,20,50,100],total:l(s).total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","total"])])]),_:1})])}}}),ue=Z(se,[["__scopeId","data-v-7a5365f9"]]);export{ue as default};
